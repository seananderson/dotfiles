# # Paths ----------------------------------------------
# set folder           = ~/.mail               # mailbox location
# set alias_file       = ~/.mutt/alias         # where to store aliases
# set header_cache     = ~/.mutt/cache/headers # where to store headers
# set message_cachedir = ~/.mutt/cache/bodies  # where to store bodies
# set certificate_file = ~/.mutt/certificates  # where to store certs
# set mailcap_path     = ~/.mutt/mailcap       # entries for filetypes
# set tmpdir           = ~/.mutt/temp          # where to keep temp files
# #set signature        = ~/.mutt/sig           # my signature file
#
# Paths ----------------------------------------------
set folder           = ~/.mail               # mailbox location
set alias_file       = ~/.mail/alias         # where to store aliases
set header_cache     = ~/.mail/cache/headers # where to store headers
set message_cachedir = ~/.mail/cache/bodies  # where to store bodies
set certificate_file = ~/.mail/certificates  # where to store certs
set mailcap_path     = ~/.mail/mailcap       # entries for filetypes
set tmpdir           = ~/.mail/temp          # where to keep temp files
#set signature        = ~/.mutt/sig           # my signature file

# Basic Options --------------------------------------
set wait_key = no        # shut up, mutt
set mbox_type = Maildir  # mailbox type
set timeout = 3          # idle time before scanning
set mail_check = 0       # minimum time between scans
unset move               # gmail does that
set delete               # don't ask, just do
unset confirmappend      # don't ask, just do!
set quit                 # don't ask, just do!!
unset mark_old           # read/new is good enough for me
set pipe_decode          # strip headers and eval mimes when piping
set thorough_search      # strip headers and eval mimes before searching
unset arrow_cursor         # use or don't use arrow cursor

unset askbcc               # don't prompt for bcc's
unset askcc                # don't prompt for cc's
unset beep                 # don't beep on error
unset beep_new             # don't beep on new message
unset text_flowed            # don't send format flowed messages

set use_from

# Sidebar Patch --------------------------------------
#set sidebar_delim   = '  │'
#set sidebar_visible = no
#set sidebar_width   = 24
#color sidebar_new color221 color233
## mutt sidebar settings
#bind index,pager \CP sidebar-prev
#bind index,pager \CN sidebar-next
#bind index,pager \CO sidebar-open
#macro index,pager B '<enter-command>toggle sidebar_visible<enter>'
# Toggle sidebar visibility
#macro index B 'toggle sidebar_visible'
#macro pager B 'toggle sidebar_visible'

# Sidebar Navigation ---------------------------------
#bind index,pager <down>   sidebar-next
#bind index,pager <up>     sidebar-prev
#bind index,pager <right>  sidebar-open

# Status Bar -----------------------------------------
set status_chars  = " *%A"
set status_format = "───[ Folder: %f ]───[%r%m messages%?n? (%n new)?%?d? (%d to delete)?%?t? (%t tagged)? ]───%>─%?p?( %p postponed )?───"

# Header Options -------------------------------------
ignore *                                # ignore all headers
unignore from: to: cc: date: subject:   # show only these
unhdr_order *                           # some distros order things by default
hdr_order from: to: cc: date: subject:  # and in this order

# Account Settings -----------------------------------

# Default inbox.
set spoolfile = "+sean-seananderson.ca/inbox"

# Alternate email addresses.
alternates sean@seananderson.ca sean_anderson@sfu.ca sean@diabolo.ca scanders@sfu.ca sc2ander@xcskier.com sean.charles.anderson@gmail.com sean@dal.ca sean.anderson@dal.ca

# Mailboxes to show in the sidebar.
mailboxes +sean-seananderson.ca/inbox \
          +sean-seananderson.ca/robots \
          +sean-seananderson.ca/toreply \
          +sean-seananderson.ca/archive \
          +sean-seananderson.ca/sent \
          +sean-seananderson.ca/flagged \
          +sean-seananderson.ca/trash \
          +sean-seananderson.ca/junk \

# Other special folders.
set mbox      = "+sean-seananderson.ca/archive"
set postponed = "+sean-seananderson.ca/drafts"

# Index View Options ---------------------------------
#set date_format = "%m/%d"
#set index_format = "[%Z]  %D  %-20.20F  %s"
set sort = threads                         # like gmail
set sort_aux = reverse-last-date-received  # like gmail
set uncollapse_jump                        # don't collapse on an unread message
set sort_re                                # thread based on regex
set reply_regexp = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"

# Index Key Bindings ---------------------------------
bind index gg       first-entry
bind index G        last-entry

bind index R        group-reply
bind index a        group-reply
bind index A        group-reply
bind index <tab>    sync-mailbox
bind index u    sync-mailbox
bind index \Cf  collapse-thread
bind index o display-message

# Ctrl-R to mark all as read
#macro index \Cr "T~U<enter><tag-prefix><clear-flag>N<untag-pattern>.<enter>" "mark all messages as read"

# Sync email
#macro index \CO "<shell-escape>offlineimap -q<enter>"           "run offlineimap to sync all mail"
macro index O "<shell-escape>mailsync.sh<enter>"           "run offlineimap to sync all mail"
#macro index O "<shell-escape>offlineimap -qf INBOX<enter>" "run offlineimap to sync inbox"
macro index 0 "<shell-escape>mailsync-inbox.sh<enter>" "run offlineimap to sync inbox"

# Saner copy/move dialogs
macro index C "<copy-message>?<toggle-mailboxes>" "copy a message to a mailbox"
macro index M "<save-message>?<toggle-mailboxes>" "move a message to a mailbox"
macro pager M "<save-message>?<toggle-mailboxes>" "move a message to a mailbox"

# Pager View Options ---------------------------------
#set pager_index_lines = 7  # number of index lines to show
#set pager_context = 3      # number of context lines to show
#set pager_stop             # don't go to next message automatically
set menu_scroll            # scroll in menus
set tilde                  # show tildes like in vim
unset markers              # no ugly plus signs

set quote_regexp = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"
alternative_order text/plain text/enriched text/html

# Pager Key Bindings ---------------------------------
bind pager K  previous-line
bind pager J  next-line
#bind pager k  previous-entry
#bind pager j  next-entry
bind pager gg top
bind pager G  bottom

bind pager R  group-reply

# View attachments properly.
bind attach <return> view-mailcap

macro pager \Cu "|urlview<enter>" "call urlview to open links"

# Compose View Options -------------------------------
set realname = "Sean Anderson"       # who am i?
set envelope_from                    # which from?
set sig_dashes                       # dashes before sig
set edit_headers                     # show headers when composing
set fast_reply                       # skip to compose when replying
set fcc_attach                       # save attachments with the body
unset mime_forward                   # forward attachments as part of body
set forward_format = "Fwd: %s"       # format of subject when forwarding
set forward_decode                   # decode when forwarding
set attribution = "On %d, %n wrote:" # format of quoting header
set reply_to                         # reply to Reply to: field
set reverse_name                     # reply as whomever it was to
set include                          # include message in replies
set forward_quote                    # include message in forwards

set editor = "vim -f +/^$ ++0"        # Use terminal Vim to compose email.

set from     = "sean@seananderson.ca"
#set sendmail = "/usr/local/bin/msmtp -a fastmail"
set sendmail = "/usr/local/bin/msmtp"
set envelope_from=yes
              
macro generic "<esc>1" ":set from=cb@tachium.at"
macro generic "<esc>2" ":set from=ch.blank@gmail.com"

set sendmail_wait = 0
set record = "+sean-seananderson.ca/sent"

# postponing
bind compose p postpone-message
bind index p recall-message
set   recall=no                # Don't ask about postponed when composing

# contacts:
set query_command = "contacts -Sf '%eTOKEN%n' '%s' | sed -e 's/TOKEN/\t/g'"
bind editor <Tab> complete-query
bind editor ^T    complete

# searching
bind index N search-opposite
bind pager N search-opposite
# limit back to all:
macro index a "<limit>all\n" "show all messages (undo limit)"

# colours
#source /Users/seananderson/.mutt/mutt-colors-solarized-dark-16.muttrc
#source /Users/seananderson/.mutt/mutt-colors-solarized-light-16.muttrc
source /Users/seananderson/.mutt/mutt-sean.muttrc
#source /Users/seananderson/.mutt/mutt-colors-solarized-light-256.muttrc
#source .mutt/zenburn.muttrc

# custom settings:
bind index,pager c mail

macro index,pager gi  "<change-folder> =sean-seananderson.ca/inbox<enter>"  "go to inbox"
macro index,pager gt  "<change-folder> =sean-seananderson.ca/sent<enter>"  "go to sent"
macro index,pager gs  "<change-folder> =sean-seananderson.ca/flagged<enter>"  "go to starred"
macro index,pager gb  "<change-folder> =sean-seananderson.ca/robots<enter>"  "go to bulk"
macro index,pager gr  "<change-folder> =sean-seananderson.ca/toreply<enter>"  "go to toreply"
macro index,pager gd  "<change-folder> =sean-seananderson.ca/drafts<enter>"  "go to drafts"
macro index,pager ga  "<change-folder> =sean-seananderson.ca/archive<enter>"  "go to archive"
macro index,pager gn  "<change-folder> =temporary/search<enter>"  "go to notmuch search results"
macro index,pager gl "<change-folder>" "change to a folder"

macro index,pager d "<save-message>=sean-seananderson.ca/trash<enter>" "move message to trash"
macro index,pager y "<save-message>=sean-seananderson.ca/archive<enter>" "move message to archive"
macro index S "<enter-command>unset wait_key<enter><shell-escape>mutt-notmuch-py ~/.mail/temporary/search<enter><change-folder-readonly>+temporary/search<enter>" "search mail (using notmuch)"

bind pager u exit
bind index $ sort-mailbox
bind index % sort-reverse


set reverse_name=yes
set reverse_realname=no

#color normal     color188 color237
#
# http://durak.org/sean/pubs/software/mutt/tuning.html
# use very high $read_inc to speed up reading hcache'd maildirs
folder-hook . 'set read_inc=2000'
# use lower value for reading slower remote IMAP folders
#folder-hook ^imap 'set read_inc=100'
# use even lower value for reading even slower remote POP folders
#folder-hook ^pop 'set read_inc=1'

# start by limiting to 3 months to make subsequent searches faster:
folder-hook archive 'push <limit>~d<3m<enter>'

#
#
#http://comments.gmane.org/gmane.mail.mutt.user/34453
#reply-hook '~s ^$' '<edit-subject><kill-line>My Custom Header<enter>'

